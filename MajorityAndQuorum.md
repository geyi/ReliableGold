问题一：
“每次读取数据都必须检查半数以上的机器上是否有这条数据” 与 5个节点的例子中说的“那么另外一个读, 只要联系到任意3个节点, 就一定能读到x=3 这就是安全的.”
前者是说一定要读到至少三个节点包含x=3；而后者是说只要能读到x=3就是安全的。那么这里是说不用达到多数派读吗？还是说后者是前者的一种放宽的说发？  
**答**：前者是说读半数的节点，读到就算ok。后者的前提是之前的写操作已经写入了3份，所以读三个节点一定能看到至少1个。

问题二：
“3个成员一共5票, 所有票数过半的集合都是quorum: {abc}, {abc, d}, {abc, e}, {abc, d, e}. 但{d, e} 不是一个quorum, 因为根据我们的定义, 只有2票没有过半.”
这里判断Qx（注：x是下标）是不是一个quorum还是要以票数为标准吗？这里是不是应该说：“因为{d, e}跟{abc}没有交集”。因为我在“TiDB 在 Raft 成员变更上踩的坑”一文中看到文章开头说的：Raft单步变更算法在每次添加或删除一个节点时，中间经历4节点的状态abcd，有可能出现网络割裂导致无法选主的问题。后面提到{c, d}也可以作为一个quorum，这里{c, d}也没有过半啊，但是{c, d}却可以作为一个quorum。  
**答**：这是只是说明可以使用带权重的方式来得出quorum。

问题三：
在“不是majority的quorum们”小节的5个例子中quorum的定义是怎么来的？还是说我只要做到在一组quorum中保证任意2个quorum都有交集，那么这一组quorum就是合法的，就是能保证quorum-rw正确性的？  
**答**：paxos中phase1的quorum和phase2只要有交集就行，phase1中的两个quorum不需要一定有交集，phase2也是。例如4节点，phase1的 quorum是3个，phase2的quorum是2，也是可以的。

## 概念
quorum是majority是一个概念推广，majority是quorum的一个特例

要保证quorum-rw的正确性，只要需要保证任意2个quorum有交集就可以了。

**通过设计quorum可以降低延迟性，但是任意一种quorum的选择，可用性都低于majority的quorum。**

## 可用性的定义
假设：
- 集群中的节点随机停机
- 在一段时间内节点停机的时间比例p = 0.01
- 且停机事件相互独立

某一时刻，如果在线的节点集合是一个quorum，那么系统就是可用的，就可以通过这个quorum完成多数派读写或paxos。否则系统就不可用。
因此系统的可用性可以定义为：

每个quorum出现的概率之和，即，$P(Q) = \Sigma P(Q_i),Q_i	\in Q$。quorum出现的概率是：$P(Q_i) = (1 - p)^xp^{n-x}$，其中x是一个quorum包含的节点个数：$x = |Q_i|$

## 可用性的分析
为什么非majority的quorum 会降低系统的可用性：
- 假设majority quorum的集合为$M$，也就是所有大小过半的节点集合
- 对某一个quorum集合$Q = \{Q_1, Q_2...\}$，其中$Q_k = \{a_i, a_j...\}$是一个节点集合，$Q_x$满足对quorum的定义：任意2个$Q_i$，$Q_j$交集都不为空：$Q_i \cup Q_j \neq \emptyset$
- 单机停机几率 p = 0.01;

我们可以对$Q$做一个变换$f(Q)$

从$Q$中选择最小的一个$Q_i$：$Q_i$满足∀Qⱼ: |Qᵢ| ≤ |Qⱼ|（如果有多个最小的，选任意一个），从$Q$中去掉$Q_i$，再把$Q_i$的补集加入

$Q' = Q$ \\ $\{Q_i\} \cup \{\overline{Q_i}\}$

$Q'$也还是一个合法的quorum集合：因为任意一个$Q_j$，如果$|Q_j| \geq |Q_i|$，且$|Q_j| \neq |Q_i|$，那么$Q_j$一定（且至少）包含一个不在$Q_i$中的节点，所以$\{\overline{Q_i}\}$和$Q_j$一定有交集。

重复这个步骤直到$Q$中所有的quorum都大于半数。最后$Q$变成$M$的一个子集：$f(Q) \subseteq M$

这样任何一个$Q$都可以跟$M$的子集建立一一映射。而$M$子集的可用性一定不大于$M$的可用性：$P(subset(M)) \leq P(M)$。

而且，对一个不大于半数的$|Q_i|(x \leq n / 2)$，它的补集在随机停机过程中出现的几率更大:
$(1 - p)^xp^{n - x} \leq (1 - p)^{n - x}p^{x}$ => $P(Q_i) \leq P(\overline{Q_i})$ => $P(Q) \leq P(f(Q))$

所以，$P(Q) \leq P(f(Q)) \leq P(M)$，即 majority 的 quorum 可靠性最高。其他任何一种quorum的选择，即使它允许更多的节点停机，也只能提供较低的可用性。